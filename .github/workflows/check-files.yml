---
name: Check Required Files

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main, develop]

jobs:
  check-files:
    runs-on: ubuntu-latest
    permissions:
      contents: read

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Check if GitHub repo exists
        run: |
          echo "✓ GitHub repository exists (implicit check - workflow is running)"

      - name: Check if requirements.txt file exists and not empty
        run: |
          if [ ! -f "requirements.txt" ]; then
            echo "❌ Error: requirements.txt file does not exist"
            exit 1
          fi
          if [ ! -s "requirements.txt" ]; then
            echo "❌ Error: requirements.txt file is empty"
            exit 1
          fi
          echo "✓ requirements.txt exists and is not empty"
          echo "File size: $(wc -c < requirements.txt) bytes"

      - name: Check if listings directory exists and not empty
        run: |
          if [ ! -d "listings" ]; then
            echo "❌ Error: listings directory does not exist"
            exit 1
          fi
          if [ -z "$(ls -A listings)" ]; then
            echo "❌ Error: listings directory is empty"
            exit 1
          fi
          echo "✓ listings directory exists and is not empty"
          echo "Files in listings:"
          ls -la listings/

      - name: Check if alx_travel_app/settings.py file exists and not empty
        run: |
          if [ ! -f "alx_travel_app/settings.py" ]; then
            echo "❌ Error: alx_travel_app/settings.py file does not exist"
            exit 1
          fi
          if [ ! -s "alx_travel_app/settings.py" ]; then
            echo "❌ Error: alx_travel_app/settings.py file is empty"
            exit 1
          fi
          echo "✓ alx_travel_app/settings.py exists and is not empty"
          echo "File size: $(wc -c < alx_travel_app/settings.py) bytes"

      - name: Check if alx_travel_app/urls.py file exists and not empty
        run: |
          if [ ! -f "alx_travel_app/urls.py" ]; then
            echo "❌ Error: alx_travel_app/urls.py file does not exist"
            exit 1
          fi
          if [ ! -s "alx_travel_app/urls.py" ]; then
            echo "❌ Error: alx_travel_app/urls.py file is empty"
            exit 1
          fi
          echo "✓ alx_travel_app/urls.py exists and is not empty"
          echo "File size: $(wc -c < alx_travel_app/urls.py) bytes"

      - name: Summary
        run: |
          echo "=========================================="
          echo "✓ All required files exist and are not empty!"
          echo "=========================================="
